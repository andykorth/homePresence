<!DOCTYPE HTML>
<html>
  <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js" type="text/javascript" charset="utf-8"></script>
<body>

<H2>
    Home Presence Monitor
</H2>

<!--
    <P>Set Servo Position:<br><br>
    <input type="range" name="degBox" id="degBoxId" min="0" max="180" step="1" value="90" list="myData" onchange="setValue(this)">
-->
    <br><br>
    <button id="Red On" onclick="led('l1', 'HIGH')">Red On</button>
    <button id="Red Off"  onclick="led('l1', 'LOW')">Red Off</button>
    <button id="Green On" onclick="led('l2', 'HIGH')">Green On</button>
    <button id="Green Off"  onclick="led('l2', 'LOW')">Green Off</button>
    <br><br>
    <P>Current State Change Count: <span id="curPos">empty</span><br>

    <script type="text/javascript">
      var deviceID    = "53ff6e066667574848470967";
      var accessToken = "01c5f7b2d98633a65068351fd2a830c083c144cc";
      var setFunc = "led";
      var getFunc = "count";

      window.setInterval(function() {
        requestURL = "https://api.spark.io/v1/devices/" + deviceID + "/" + getFunc + "/?access_token=" + accessToken;
        $.getJSON(requestURL, function(json) {
                 document.getElementById("curPos").innerHTML = json.result;
                 document.getElementById("curPos").style.fontSize = "28px";
                 });
      }, 1000);
      
    function led(light, state){
        sparkSetLedState(light, state)
        
        
    }

    function setValue(obj) {
        var newValue = document.getElementById('degBoxId').value;
        sparkSetPos(newValue);
    }

    function sparkSetPos(newValue) {
        var requestURL = "https://api.spark.io/v1/devices/" +deviceID + "/" + setFunc + "/";
        $.post( requestURL, { params: newValue, access_token: accessToken });
    }
    
    function sparkSetLedState(ledNumber, state) {
        var requestURL = "https://api.spark.io/v1/devices/" +deviceID + "/" + setFunc + "/";
        $.post( requestURL, { params: ledNumber + "," + state, access_token: accessToken });
    }
    
    </script>
</body>
</html>



